configurations.all {
    resolutionStrategy {
        eachDependency { DependencyResolveDetails det ->
            /* JAR upgrades with latest versions for CVE fixes*/

            /*
            * CVE-2020-11996, CVE-2020-13934, CVE-2020-13935, CVE-2020-13943,
            *  CVE-2020-17527, CVE-2020-8022, CVE-2020-9484
            *  CVE-2021-25122, CVE-2021-25329
            * */
            if (det.requested.name == 'tomcat-embed-core') {
                det.useVersion '9.0.43'
            }
            if (det.requested.name == 'tomcat-embed-websocket') {
                det.useVersion '9.0.43'
            }

            /*
                CVE-2020-25649
             */
            if (det.requested.group == 'com.fasterxml.jackson.core') {
                det.useVersion '2.12.1'
            }

            /*
                 Prototype pollution Vulnerability
            * */
            if (det.requested.name == 'handlebars') {
                det.useVersion '4.2.0'
            }

            /*
                 CVE-2020-26939
            * */
            if (det.requested.name == 'bcprov-jdk15on') {
                det.useVersion '1.68'
            }

            /*
                CVE-2021-28165, CVE-2021-28163, CVE-2021-28164
            * */
            if(det.requested.name == 'jetty-client' || det.requested.name == 'jetty-continuation' || det.requested.name == 'jetty-http'
                    ||det.requested.name == 'jetty-security' ||det.requested.name == 'jetty-servlet' ||det.requested.name == 'jetty-servlets'
                    ||det.requested.name == 'jetty-util' ||det.requested.name == 'jetty-webapp' ||det.requested.name == 'jetty-xml'
                    ||det.requested.name == 'jetty-server' ||det.requested.name == 'jetty-_http_server' ||det.requested.name == 'jetty-util-ajax'
                    ||det.requested.name == 'mortbay_jetty'){
                det.useVersion '9.4.39.v20210325'
            }

            /*
                CVE-2021-22112
            **/

            if(det.requested.name == 'spring-security-config' || det.requested.name == 'spring-security-core' || det.requested.name == 'spring-security-crypto'
                    ||det.requested.name == 'spring-security-web'){
                det.useVersion '5.4.5'
            }

            /*
                CVE-2020-13956
            * */
            if (det.requested.name == 'httpclient') {
                det.useVersion '4.5.13'
            }

            /*
                CVE-2020-25638
            * */
            if (det.requested.name == 'hibernate-core') {
                det.useVersion '5.4.27.Final'
            }

            /*
                CVE-2020-15250
            * */
            if (det.requested.name == 'junit' && det.requested.group == 'junit') {
                det.useVersion '4.13.1'
            }

            /*
                CVE-2019-10086
            */
            if (det.requested.name == 'commons-beanutils') {
                det.useVersion '1.9.4'
            }

            /*
                CVE-2019-0223
            * */
            if (det.requested.name == 'proton-j') {
                det.useVersion '0.33.8'
            }

            /*
                CVE-2018-1270
            */
            if (det.requested.name == 'feign-form-spring') {
                det.useVersion '3.8.0'
            }

            /*
                CVE-2018-10237
            * */
            if (det.requested.name == 'guava') {
                det.useVersion '30.1-jre'
            }

            /*
                CVE-2017-18640
            * */
            if(det.requested.name == 'snakeyaml'){
                det.useVersion '1.27'
            }

            /*
                CVE-2012-6708, CVE-2015-9251, CVE-2019-11358
            **/
            if(det.requested.name == 'ff4j-web'){
                det.useVersion '1.8.11'
            }

            /*
                CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')
            * */
            if(det.requested.name == 'hystrix-core'){
                det.useVersion '1.5.18'
            }

            /*
                CVE-2008-1392, CVE-2009-0177, CVE-2009-0908, CVE-2009-1146, CVE-2009-1147, CVE-2009-1244, CVE-2009-1805
            * */
            if (det.requested.name == 'micrometer-core' && det.requested.group == 'io.micrometer') {
                det.useVersion '1.6.3'
            }
            /* CVE fix with latest group ends here*/

            /*
                CVE-2020-5398 - The build fails with latest version and hence latest version is not used here
            * */
            if (det.requested.name == 'spring-context') {
                det.useVersion '5.2.9.RELEASE'
            }

            /* CVE-2021-29425 */
            if (det.requested.name == 'commons-io') {
                det.useVersion '2.8.0'
            }

            /* CVE fix group where the latest version not used, ends here*/

        }
    }
}
