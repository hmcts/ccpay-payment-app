configurations.all {
    resolutionStrategy {
        eachDependency { DependencyResolveDetails det ->
            /* JAR upgrades with latest versions for CVE fixes*/

            /*
                CVE-2021-28165, CVE-2021-28163, CVE-2021-28164, CVE-2021-28165, CVE-2021-28169, CVE-2021-34429
            * */
            if (det.requested.name == 'jetty-client' || det.requested.name == 'jetty-continuation' || det.requested.name == 'jetty-http'
                    || det.requested.name == 'jetty-security' || det.requested.name == 'jetty-servlet' || det.requested.name == 'jetty-servlets'
                    || det.requested.name == 'jetty-util' || det.requested.name == 'jetty-webapp' || det.requested.name == 'jetty-xml'
                    || det.requested.name == 'jetty-server' || det.requested.name == 'jetty-_http_server' || det.requested.name == 'jetty-util-ajax'
                    || det.requested.name == 'mortbay_jetty' || det.requested.name == 'jetty-io') {
                det.useVersion '11.0.25'
            }


            /* CVE-2025-58056, CVE-2025-55163, CVE-2025-58057 (Netty) */
            if (det.requested.group == 'io.netty'
                    && det.requested.name.startsWith('netty-')
                    && !det.requested.name.startsWith('netty-tcnative')) {
                // Use a patched 4.1.x. 4.1.127.Final includes the fixes.
                det.useVersion '4.1.127.Final'
            }

            /* CVE-2025-31672 */
            if (det.requested.name == 'org.apache.poi') {
                det.useVersion '5.4.1'
            }

            /*CVE-2021-35515, CVE-2021-35516, CVE-2021-35517, CVE-2021-36090, CVE-2024-26308*/
            if (det.requested.name == 'commons-compress') {
                det.useVersion '1.26.2'
            }

            /* CVE-2025-24813 */
            if (det.requested.name == 'nimbus-jose-jwt') {
                det.useVersion '9.38'
            }

            /* CVE-2025-48734 */
            if (det.requested.group == 'commons-beanutils') {
                det.useVersion '1.11.0'
            }

            /* CVE-2025-48976 */
            if (det.requested.name == 'commons-fileupload') {
                det.useVersion '1.6.0'
            }

            /* CVE-2025-48989 */
            if (['tomcat-embed-core', 'tomcat-embed-websocket', 'tomcat-embed-jasper', 'tomcat-embed-el'].contains(det.requested.name)) {
                det.useVersion '10.1.44'
            }
            /*
                CVE-2025-48924
            */
            if (det.requested.group == 'org.apache.commons' && det.requested.name == 'commons-lang3') {
                det.useVersion '3.18.0'
            }
        }
    }
}
